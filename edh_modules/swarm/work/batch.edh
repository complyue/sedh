#
# Swarm batch work manager
#

import * 'swarm/symbols'
import * 'swarm/headhunter'


export producer manageBatchJobs(
  params,  # generator or producer providing all ips
  outlet,  # our producing target sink
) {
  case HeadHunter(outlet) of { hh } -> { pass }
  for ips from params() do {
    case type(ips) of {  # ensure ips of apk type
      ArgsPackType -> { pass }
      _ -> ips = pkargs(ips)
    }
    # blocking wait the job dispatched
    hh.dispatchJob(ips)
  }
}

